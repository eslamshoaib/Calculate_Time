# HTML Page with Google Maps Link Generator from Coordinates

Here's an HTML page that extracts coordinates from your Excel data, converts them to Google Maps links, and displays all the original data in a horizontal table with the added map link:

```html
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>استخراج إحداثيات جوجل ماب</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            color: #4285F4;
            text-align: center;
        }
        .upload-section {
            background-color: #f5f5f5;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
            text-align: center;
            border: 2px dashed #ccc;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
            position: sticky;
            top: 0;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .map-link {
            color: #4285F4;
            text-decoration: none;
        }
        .map-link:hover {
            text-decoration: underline;
        }
        button {
            background-color: #4285F4;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #3367D6;
        }
        .instructions {
            background-color: #FFF3E0;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-right: 4px solid #FFA000;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>استخراج إحداثيات جوجل ماب من ملف Excel</h1>
        
        <div class="instructions">
            <h3>تعليمات الاستخدام:</h3>
            <ol>
                <li>قم بتحميل ملف Excel الذي يحتوي على بيانات الخلايا</li>
                <li>يجب أن يحتوي الملف على عمود بالإحداثيات بالشكل: N 3121258 E 2713105</li>
                <li>سيتعرف البرنامج تلقائياً على الإحداثيات ويحولها لرابط جوجل ماب</li>
            </ol>
        </div>
        
        <div class="upload-section">
            <input type="file" id="excelFile" accept=".xlsx, .xls" />
            <button onclick="processFile()">معالجة الملف</button>
        </div>
        
        <div id="results">
            <table id="dataTable">
                <thead>
                    <tr>
                        <th>MSISDN</th>
                        <th>IMSI</th>
                        <th>IMEI</th>
                        <th>Covering_Switch</th>
                        <th>Cell_ID</th>
                        <th>Cell_Number</th>
                        <th>LAC</th>
                        <th>status4g</th>
                        <th>MME</th>
                        <th>MINOR_AREA</th>
                        <th>CITY</th>
                        <th>LANDLORD_ADDRESS</th>
                        <th>الإحداثيات</th>
                        <th>SITE_ID</th>
                        <th>Mobile_state</th>
                        <th>رابط جوجل ماب</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <!-- Data will be inserted here -->
                </tbody>
            </table>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        function processFile() {
            const fileInput = document.getElementById('excelFile');
            const file = fileInput.files[0];
            
            if (!file) {
                alert("الرجاء اختيار ملف Excel أولاً");
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                
                // Get the first sheet
                const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                
                // Convert to JSON
                const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
                
                // Process the data
                displayData(jsonData);
            };
            reader.readAsArrayBuffer(file);
        }
        
        function displayData(data) {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
            
            // Skip header row if exists
            const startRow = data[0][0] === 'MSISDN' ? 1 : 0;
            
            for (let i = startRow; i < data.length; i++) {
                const row = data[i];
                if (row.length === 0) continue;
                
                const tr = document.createElement('tr');
                
                // Create cells for each column
                for (let j = 0; j < 15; j++) {
                    const td = document.createElement('td');
                    td.textContent = row[j] || '';
                    tr.appendChild(td);
                }
                
                // Process coordinates and add Google Maps link
                const coordinatesCell = document.createElement('td');
                if (row[12]) {
                    const coords = extractCoordinates(row[12]);
                    if (coords) {
                        const mapLink = `https://www.google.com/maps?q=${coords.lat},${coords.lng}`;
                        const linkElement = document.createElement('a');
                        linkElement.href = mapLink;
                        linkElement.target = "_blank";
                        linkElement.className = "map-link";
                        linkElement.textContent = "عرض على الخريطة";
                        coordinatesCell.appendChild(linkElement);
                    } else {
                        coordinatesCell.textContent = "تنسيق إحداثيات غير معروف";
                    }
                }
                tr.appendChild(coordinatesCell);
                
                tableBody.appendChild(tr);
            }
        }
        
        function extractCoordinates(coordString) {
            // Example format: "N 3121258 E 2713105"
            const regex = /N\s*(\d+)\s*E\s*(\d+)/i;
            const match = coordString.match(regex);
            
            if (match && match.length === 3) {
                // Convert to decimal degrees (assuming format is N DDMMSS E DDDMMSS)
                const latDeg = match[1].substring(0, 2);
                const latMin = match[1].substring(2, 4);
                const latSec = match[1].substring(4, 6);
                const lat = parseFloat(latDeg) + (parseFloat(latMin)/60) + (parseFloat(latSec)/3600);
                
                const lngDeg = match[2].substring(0, 3);
                const lngMin = match[2].substring(3, 5);
                const lngSec = match[2].substring(5, 7);
                const lng = parseFloat(lngDeg) + (parseFloat(lngMin)/60) + (parseFloat(lngSec)/3600);
                
                return { lat: lat.toFixed(6), lng: lng.toFixed(6) };
            }
            
            return null;
        }
    </script>
</body>
</html>
```

## كيفية استخدام هذه الصفحة:

1. قم بحفظ الكود أعلاه في ملف باسم `map-extractor.html`
2. افتح الملف في متصفح الويب
3. انقر على زر "اختيار ملف" وحدد ملف Excel الخاص بك
4. انقر على زر "معالجة الملف"
5. ستعرض الصفحة جميع البيانات من ملف Excel مع عمود إضافي يحتوي على رابط جوجل ماب

## ملاحظات:

- الصفحة مصممة للتعامل مع تنسيق الإحداثيات الموجود في ملفك (مثل: N 3121258 E 2713105)
- يتم تحويل الإحداثيات إلى تنسيق خطوط الطول والعرض العشرية
- الروابط تفتح في نافذة جديدة عند النقر عليها
- الصفحة تستخدم مكتبة SheetJS لقراءة ملفات Excel

إذا كان تنسيق الإحداثيات في ملفاتك مختلفاً، قد تحتاج إلى تعديل دالة `extractCoordinates()` في الكود.