<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>الرقم القومي المصري | National ID Analyzer</title>
    <style>
        /* General Styling */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            direction: rtl;
        }
        .container {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px 30px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 500px;
            text-align: center;
        }
        h1 {
            color: #333;
            margin-bottom: 20px;
        }
        select, input, button {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        button:hover {
            background-color: #0056b3;
        }
        /* Popup Styling */
        .popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.9);
            padding: 20px 30px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translate(-50%, -60%) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }
        .popup table {
            width: 100%;
            margin-top: 20px;
            border-collapse: collapse;
        }
        .popup th, .popup td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        .popup th {
            background-color: #f4f4f4;
        }
        .popup .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: red;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
        }
        /* Overlay */
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }
        .error {
            color: red;
            font-size: 16px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>تحليل الرقم القومي المصري</h1>
    <!-- Language Selection -->
    <select id="language" onchange="changeLanguage()">
        <option value="ar">العربية</option>
        <option value="en">English</option>
    </select>
    <!-- National ID Input -->
    <input type="text" id="nationalID" placeholder="أدخل الرقم القومي هنا..." maxlength="14">
    <button onclick="analyzeNationalID()">تحليل الرقم القومي</button>
    <div id="idError" class="error"></div>
</div>

<!-- Popup for Results -->
<div class="popup" id="resultsPopup">
    <button class="close-btn" onclick="closePopup()">&times;</button>
    <table>
        <thead>
            <tr>
                <th>المعلومات</th>
                <th>القيمة</th>
            </tr>
        </thead>
        <tbody id="popupResultsBody">
            <!-- Dynamic rows will be added here -->
        </tbody>
    </table>
</div>

<!-- Overlay -->
<div class="overlay" id="overlay"></div>

<script>
    let language = "ar"; // Default language

    function changeLanguage() {
        language = document.getElementById("language").value;
        updateLabels();
    }

    function updateLabels() {
        const labels = {
            ar: {
                analyzeBtn: "تحليل الرقم القومي",
                ageBtn: "احسب العمر",
                dateDiffBtn: "احسب الفرق بين التاريخين",
                dobPlaceholder: "تاريخ الميلاد (DD-MM-YYYY)",
                nationalIDPlaceholder: "أدخل الرقم القومي هنا...",
                date1Placeholder: "التاريخ الأول (DD-MM-YYYY)",
                date2Placeholder: "التاريخ الثاني (DD-MM-YYYY)"
            },
            en: {
                analyzeBtn: "Analyze National ID",
                ageBtn: "Calculate Age",
                dateDiffBtn: "Calculate Date Difference",
                dobPlaceholder: "Date of Birth (DD-MM-YYYY)",
                nationalIDPlaceholder: "Enter National ID here...",
                date1Placeholder: "First Date (DD-MM-YYYY)",
                date2Placeholder: "Second Date (DD-MM-YYYY)"
            }
        };
        document.querySelector('button[onclick="analyzeNationalID()"]').textContent = labels[language].analyzeBtn;
    }

    function analyzeNationalID() {
        const id = document.getElementById("nationalID").value;
        const errorDiv = document.getElementById("idError");
        if (id.length !== 14 || isNaN(id)) {
            errorDiv.textContent = language === "ar" ? "الرقم القومي غير صحيح!" : "Invalid National ID!";
            return;
        }
        errorDiv.textContent = "";

        // Extracting details from the national ID
        const century = id.charAt(0);
        const year = parseInt(id.substring(1, 3));
        const month = parseInt(id.substring(3, 5));
        const day = parseInt(id.substring(5, 7));
        const governorateCode = id.substring(7, 9);
        const registrationNumber = id.substring(9, 12); // Individual registration number
        const genderCode = parseInt(id.charAt(12));
        const identityType = id.charAt(13); // Type of identity (temporary or permanent)

        const governorates = {
            "01": "القاهرة", "02": "الإسكندرية", "03": "بورسعيد", "04": "السويس",
            "11": "دمياط", "12": "الدقهلية", "13": "الشرقية", "14": "القليوبية",
            "15": "كفر الشيخ", "16": "الغربية", "17": "المنوفية", "18": "البحيرة",
            "19": "الإسماعيلية", "21": "الجيزة", "22": "بني سويف", "23": "الفيوم",
            "24": "الأقصر", "25": "سوهاج", "26": "قنا", "27": "أسوان", "28": "أسوط",
            "29": "مطروح", "31": "شمال سيناء", "32": "جنوب سيناء", "33": "البحر الأحمر",
            "88": "خارج الجمهورية"
        };

        const birthDate = new Date((century === "2" ? "19" : "20") + year, month - 1, day);
        const gender = genderCode >= 1 && genderCode <= 4 ? "ذكر" : "أنثى";
        const governorate = governorates[governorateCode] || "غير معروف";
        const identityTypeName = identityType === "1" ? "دائمة" : "مؤقتة";

        const today = new Date();
        let ageYears = today.getFullYear() - birthDate.getFullYear();
        let ageMonths = today.getMonth() - birthDate.getMonth();
        let ageDays = today.getDate() - birthDate.getDate();
        if (ageDays < 0) {
            ageMonths--;
            ageDays += getDaysInMonth(today.getFullYear(), today.getMonth());
        }
        if (ageMonths < 0) {
            ageYears--;
            ageMonths += 12;
        }

        const daysUntilBirthday = calculateDaysUntilBirthday(birthDate);
        const zodiacSign = getZodiacSign(month, day);

        const results = [
            { key: "تاريخ الميلاد", value: birthDate.toLocaleDateString("ar-EG") },
            { key: "العمر", value: `${ageYears} سنة, ${ageMonths} شهر, ${ageDays} يوم` },
            { key: "الجنس", value: gender },
            { key: "المحافظة", value: governorate },
            { key: "رقم التسجيل الفردي", value: registrationNumber },
            { key: "نوع الهوية", value: identityTypeName },
            { key: "البرج الفلكي", value: zodiacSign },
            { key: "عدد الأيام المتبقية لعيد الميلاد", value: `${daysUntilBirthday} يوم` }
        ];

        showPopup(results);
    }

    function getDaysInMonth(year, month) {
        return new Date(year, month + 1, 0).getDate();
    }

    function calculateDaysUntilBirthday(birthDate) {
        const today = new Date();
        const thisYearBirthday = new Date(today.getFullYear(), birthDate.getMonth(), birthDate.getDate());
        if (thisYearBirthday < today) {
            thisYearBirthday.setFullYear(today.getFullYear() + 1);
        }
        return Math.ceil((thisYearBirthday - today) / (1000 * 60 * 60 * 24));
    }

    function getZodiacSign(month, day) {
        const zodiacSigns = [
            { sign: "الحمل", start: { month: 3, day: 21 }, end: { month: 4, day: 19 } },
            { sign: "الثور", start: { month: 4, day: 20 }, end: { month: 5, day: 20 } },
            { sign: "الجوزاء", start: { month: 5, day: 21 }, end: { month: 6, day: 20 } },
            { sign: "السرطان", start: { month: 6, day: 21 }, end: { month: 7, day: 22 } },
            { sign: "الأسد", start: { month: 7, day: 23 }, end: { month: 8, day: 22 } },
            { sign: "العذراء", start: { month: 8, day: 23 }, end: { month: 9, day: 22 } },
            { sign: "الميزان", start: { month: 9, day: 23 }, end: { month: 10, day: 22 } },
            { sign: "العقرب", start: { month: 10, day: 23 }, end: { month: 11, day: 21 } },
            { sign: "القوس", start: { month: 11, day: 22 }, end: { month: 12, day: 21 } },
            { sign: "الجدي", start: { month: 12, day: 22 }, end: { month: 1, day: 19 } },
            { sign: "الدلو", start: { month: 1, day: 20 }, end: { month: 2, day: 18 } },
            { sign: "الحوت", start: { month: 2, day: 19 }, end: { month: 3, day: 20 } }
        ];

        for (const sign of zodiacSigns) {
            if ((month === sign.start.month && day >= sign.start.day) ||
                (month === sign.end.month && day <= sign.end.day)) {
                return sign.sign;
            }
        }
        return "غير معروف";
    }

    function showPopup(results) {
        const popup = document.getElementById("resultsPopup");
        const overlay = document.getElementById("overlay");
        const tbody = document.getElementById("popupResultsBody");

        // Clear previous results
        tbody.innerHTML = "";

        // Add new results
        results.forEach(result => {
            const row = document.createElement("tr");
            const keyCell = document.createElement("td");
            const valueCell = document.createElement("td");
            keyCell.textContent = result.key;
            valueCell.textContent = result.value;
            row.appendChild(keyCell);
            row.appendChild(valueCell);
            tbody.appendChild(row);
        });

        // Show popup and overlay
        popup.style.display = "block";
        overlay.style.display = "block";
    }

    function closePopup() {
        const popup = document.getElementById("resultsPopup");
        const overlay = document.getElementById("overlay");

        // Hide popup and overlay
        popup.style.display = "none";
        overlay.style.display = "none";
    }

    updateLabels();
</script>
</body>
</html>
